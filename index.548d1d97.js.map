{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-7310763169f1275a.js","fetchTopBooks.js","fetchById.js","node_modules/@parcel/runtime-js/lib/runtime-9cc6be9e3e2c7555.js","node_modules/@parcel/runtime-js/lib/runtime-b775a9f1743c03cb.js","node_modules/@parcel/runtime-js/lib/runtime-c17619eb82d4e8e0.js","src/index.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"5ZPII\\\":\\\"index.548d1d97.js\\\",\\\"aMVCO\\\":\\\"amazon.1427c9fc.jpg\\\",\\\"dSznB\\\":\\\"bookshop.0e4aa455.jpg\\\",\\\"b2DY9\\\":\\\"image1.c5cbee86.jpg\\\"}\"));","const BASE_URL='https://books-backend.p.goit.global/books/top-books';\n\nasync function fetchTopBooks(){\n    return await fetch(`${BASE_URL}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchTopBooks};","const BASE_URL='https://books-backend.p.goit.global/books/';\n\nasync function fetchBookById(idBook){\n    return await fetch(`${BASE_URL}/${idBook}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchBookById};","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"aMVCO\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"dSznB\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"b2DY9\")).toString();","import API from '../fetchTopBooks';\nimport AP from '../fetchById';\nimport APII from '../fetchAllCategories';\nimport APP from '../fetchCategory';\n\nimport imageAmazon from './images/amazon.jpg';\nimport imageBookShop from './images/bookshop.jpg';\nimport imageImage from './images/image1.jpg';\n\nconst refs={\n    ul: document.querySelector('.js-books-list'),\n    closeModalBtn: document.querySelector('[data-action=\"close-modal\"]'),\n    backdrop: document.querySelector('.js-backdrop'),\n    bookCard: document.querySelector('.js-book-card'),\n    shoppingListBtn: document.querySelector('[data-action=\"shopping-list-modal\"]'),\n    //text: document.querySelector('.js-modal-text'),\n}\n\nconst STORAGE_KEY = 'info-shopping-list';\nlet idBook=0;\nlet currentBookInfo={};\n\nconst savedData=localStorage.getItem(STORAGE_KEY);\n//console.log('savedData=',savedData);\nlet arrShoppingList=JSON.parse(savedData) || [];\n\nconsole.log('arrShoppingList= ', arrShoppingList);\n\n// console.log(refs.closeModalBtn);\n// console.log(refs.backdrop);\n\nrefs.ul.addEventListener('click',onItemGalleryBooksClick);\nrefs.closeModalBtn.addEventListener('click', onCloseModal);\nrefs.backdrop.addEventListener('click', onBackdropClick);\nrefs.shoppingListBtn.addEventListener('click', onShoppingListBtnClick);\n\n///////////////////////////////////////////////////////////////////////////////////////\nAPI.fetchTopBooks().then(createMarkupGalleryBooks);\n// //.catch(err=>console.log('Ooops! Something went wrong!'));\n\n// APII.fetchAllCategories().then(createMarkupGalleryBooks);\n//.catch(err=>console.log('Ooops! Something went wrong!'));\n//APP.fetchCategory('Advice How-To and Miscellaneous').then(createMarkupGalleryBooks);\n\nfunction createMarkupGalleryBooks(arr) {\n    //console.log('createMarkupGalleryBooks',arr);\n    // console.log(arr[0].books[0]);\n    const markup=arr[0].books.map(\n        ({\n        _id,\n        book_image,\n        book_image_width,\n        book_image_height,\n        }) =>\n        `<li ><div class=\"thumb\"><img class=\"js-gallery-image\" src=\"${book_image}\" alt=\"\" width=\"${book_image_width}px\" height=\"${book_image_height}px\" data-id=\"${_id}\"/><div></li>`\n      )\n      .join(\"\");\n      // console.log(markup);\n      refs.ul.innerHTML=markup;\n }\n// ////////////////////////////////////////////////////////////////////////////////////\nfunction onItemGalleryBooksClick(event){\n    event.preventDefault();\n\n    const isImageGalleryEl=event.target.classList.contains('js-gallery-image');\n    if(!isImageGalleryEl){\n        return;\n    }\n\n   // console.log(event.target.dataset.id);\n    idBook=event.target.dataset.id;\n\n    // const isBookInShoppingList=arrShoppingList!==null?arrShoppingList.includes(idBook):false;\n\n    const isBookInShoppingList=arrShoppingList.length===0\n    ?false\n    :arrShoppingList.find(book=>book.currentBookId===idBook);\n\n    //console.log('isBookInShoppingList=',isBookInShoppingList);\n\n    if(isBookInShoppingList){\n      refs.shoppingListBtn.textContent='remove from the shopping list';\n      refs.shoppingListBtn.classList.add('modal__button-shopping-list--remove');\n     // refs.text.classList.remove('visually-hidden');\n    }\n    else{\n      refs.shoppingListBtn.textContent='add to shopping list';\n      //refs.text.classList.add('visually-hidden');\n      refs.shoppingListBtn.classList.remove('modal__button-shopping-list--remove');\n    }\n    refs.bookCard.innerHTML='';\n\n    AP.fetchBookById(idBook)\n    .then(createMarkupBookModal);\n    //.catch(err=>console.log('Ooops! Something went wrong!'));\n\n    onOpenModal();\n    \n}\n\n\n\n\nfunction onOpenModal() {\n    window.addEventListener('keydown', onEscKeyPress);\n    document.body.classList.add('show-modal');\n\n    //console.log('onOpenModal');\n\n\n}\n  \n  function onCloseModal() {\n    window.removeEventListener('keydown', onEscKeyPress);\n    document.body.classList.remove('show-modal');\n\n  }\n  \n  function onBackdropClick(event) {\n    if (event.currentTarget === event.target) {\n      //console.log('Кликнули именно в бекдроп!!!!');\n      onCloseModal();\n    }\n  }\n  \n  function onEscKeyPress(event) {\n    const ESC_KEY_CODE = 'Escape';\n    const isEscKey = event.code === ESC_KEY_CODE;\n    if (isEscKey) {\n      onCloseModal();\n    }\n  }\n\n\n  function createMarkupBookModal(arrayInfoBook){\n    //console.log('createMarkupBookModal: ', arrayInfoBook);\n\n   const {book_image, author, title, description,buy_links, _id, list_name}=arrayInfoBook;\n\n    currentBookInfo.bookId=_id;\n    currentBookInfo.bookAuthor=author;\n    currentBookInfo.bookTitle=title;\n    currentBookInfo.bookDescription=description;\n    currentBookInfo.bookCategory=list_name;\n    currentBookInfo.bookImage=book_image;\n    currentBookInfo.bookAmazon=buy_links[0].url;\n    currentBookInfo.bookOpenBook=buy_links[1].url;\n    currentBookInfo.bookShop=buy_links[4].url;\n\n    console.log('currentBookInfo', currentBookInfo);\n    \n    const markup=\n    `<div class=\"img-thumb\"><img class=\"book-image\"\" src=\"${book_image}\" alt=\"${title}\" loading=\"lazy\" data-source=\"${_id}\"/>\n    </div>\n    <div class=\"book-description-thumb\">\n    <p class=\"book-title\">${title}</p>\n    <p class=\"book-author\">${author}</p>\n    <p class=\"book-description\">${description}</p>\n    <div class=\"book-links\">\n    <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageAmazon}\" width=\"62px\" height=\"19px\"/>\n    </a>\n    <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageImage}\" width=\"33px\" height=\"32px\"/>\n    </a>\n    <a href=\"${buy_links[4].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageBookShop}\" width=\"38px\" height=\"36px\"/>\n    </a>\n    </div>\n    </div>`;\n\n    \n    //console.log(markup);\n    refs.bookCard.innerHTML=markup;\n  }\n\n\n  function onShoppingListBtnClick(event){\n    //const indexBook=arrShoppingList.indexOf(idBook);\n\n    console.log('onShoppingListBtnClick arrShoppingList=', arrShoppingList);\n    console.log('onShoppingListBtnClick currentBookInfo=', currentBookInfo.bookAuthor);\n    \n    const indexBook=arrShoppingList.findIndex(book=>book.currentBookId===currentBookInfo.bookId);\n      \n    console.log('onShoppingListBtnClick indexBook=', indexBook);\n\n    if(indexBook!==-1){\n        arrShoppingList.splice(indexBook,1);\n        console.log('onShoppingListBtnClick  remove arrShoppingList=', arrShoppingList);\n       localStorage.removeItem(STORAGE_KEY);\n       localStorage.setItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }\n    else{\n        arrShoppingList.push({...currentBookInfo});\n      \n        console.log('onShoppingListBtnClick add arrShoppingList=', arrShoppingList);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }   \n      onCloseModal();\n  }\n\n"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$795d36ee4409a10a$export$2e2bcd8739ae039","async","fetch","then","resp","ok","statusText","json","$27d6f1b99820d37d$export$2e2bcd8739ae039","idBook","$a37ce9e90c4fe847$exports","URL","resolve","import","meta","url","toString","$b0768e3c833ef454$exports","$246326594a1b55d9$exports","$1f0dc3b9307be026$var$refs","ul","document","querySelector","closeModalBtn","backdrop","bookCard","shoppingListBtn","$1f0dc3b9307be026$var$idBook","$1f0dc3b9307be026$var$currentBookInfo","$1f0dc3b9307be026$var$savedData","localStorage","getItem","$1f0dc3b9307be026$var$arrShoppingList","$1f0dc3b9307be026$var$onCloseModal","window","removeEventListener","$1f0dc3b9307be026$var$onEscKeyPress","body","classList","remove","event","code","$1f0dc3b9307be026$var$createMarkupBookModal","arrayInfoBook","book_image","author","title","description","buy_links","_id","list_name","bookId","bookAuthor","bookTitle","bookDescription","bookCategory","bookImage","bookAmazon","bookOpenBook","bookShop","console","log","markup","$parcel$interopDefault","innerHTML","addEventListener","preventDefault","target","contains","dataset","find","book","currentBookId","textContent","add","fetchBookById","currentTarget","indexBook","findIndex","splice","removeItem","setItem","stringify","push","fetchTopBooks","arr","books","map","book_image_width","book_image_height","join"],"version":3,"file":"index.548d1d97.js.map"}