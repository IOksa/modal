{"mappings":"IAYAA,EAAe,C,cAVfC,iBACI,aAAaC,MAAM,uDAClBC,MAAMC,IACH,IAAKA,EAAKC,GACR,MAAM,IAAIC,MAAMF,EAAKG,YAEvB,OAAOH,EAAKI,MAAM,G,OCI1BC,EAAe,C,cAVfR,eAA6BS,GACzB,aAAaR,MAAM,8CAAeQ,KACjCP,MAAMC,IACH,IAAKA,EAAKC,GACR,MAAM,IAAIC,MAAMF,EAAKG,YAEvB,OAAOH,EAAKI,MAAM,G,GCL1B,MAAMG,EAAK,CACPC,GAAIC,SAASC,cAAc,kBAC3BC,cAAeF,SAASC,cAAc,+BACtCE,SAAUH,SAASC,cAAc,gBACjCG,SAAUJ,SAASC,cAAc,iBACjCI,gBAAiBL,SAASC,cAAc,uCACxCK,KAAMN,SAASC,cAAc,mBAIjC,IAAIM,EAAO,EA6ET,SAASC,IACPC,OAAOC,oBAAoB,UAAWC,GACtCX,SAASY,KAAKC,UAAUC,OAAO,a,CAWjC,SAASH,EAAcI,GACA,WACJA,EAAMC,MAErBR,G,CAQJ,SAASS,EAAsBC,GAG7B,MAAMC,WAACA,EAAUC,OAAEA,EAAMC,MAAEA,EAAKC,YAAEA,EAAWC,UAACA,EAASC,IAAEA,GAAKN,EAExDO,EACN,wDAAwDN,WAAoBE,kCAAsCG,yFAG1FH,qCACCD,0CACKE,qDAEnBC,EAAU,GAAGG,4IAGbH,EAAU,GAAGG,4IAGbH,EAAU,GAAGG,uJAQxB5B,EAAKM,SAASuB,UAAUF,C,CAgB1B,SAASG,IACP,OAAOC,aAAaC,QAnJJ,SAmJyBvB,E,CA9I7CT,EAAKC,GAAGgC,iBAAiB,SA0BzB,SAAiChB,GAC7BA,EAAMiB,iBAGN,IADuBjB,EAAMkB,OAAOpB,UAAUqB,SAAS,kBAEnD,OAGJC,QAAQC,IAAIrB,EAAMkB,OAAOI,QAAQC,QACjC/B,EAAOQ,EAAMkB,OAAOI,QAAQC,OAE5B,MAAMC,EAAqBX,IAE3BO,QAAQC,IAAI,wBAAwBG,GAEjCA,IAAuBhC,GACxBT,EAAKO,gBAAgBmC,YAAY,gCACjC1C,EAAKO,gBAAgBQ,UAAU4B,IAAI,uCACnC3C,EAAKQ,KAAKO,UAAUC,OAAO,qBAG3BhB,EAAKO,gBAAgBmC,YAAY,uBACjC1C,EAAKQ,KAAKO,UAAU4B,IAAI,mBACxB3C,EAAKO,gBAAgBQ,UAAUC,OAAO,wCAExChB,EAAKM,SAASuB,UAAU,GAExB/B,EAAG8C,cAAcnC,GAChBjB,KAAK2B,GAWNR,OAAOsB,iBAAiB,UAAWpB,GACnCX,SAASY,KAAKC,UAAU4B,IAAI,a,IAjEhC3C,EAAKI,cAAc6B,iBAAiB,QAASvB,GAC7CV,EAAKK,SAAS4B,iBAAiB,SA6E7B,SAAyBhB,GACnBA,EAAM4B,gBAAkB5B,EAAMkB,QAEhCzB,G,IA/ENV,EAAKO,gBAAgB0B,iBAAiB,SA8HpC,SAAgChB,GAEHa,MACDrB,EACxBsB,aAAae,WA1IC,SA0IuBrC,GAGrCsB,aAAagB,QA7IC,SA6IoBtC,GAEpCC,G,IApIJrB,EAAI2D,gBAAgBxD,MAGpB,SAAkCyD,GAG9B,MAAMtB,EAAOsB,EAAI,GAAGC,MAAMC,KACtB,EAACzB,IACDA,EAAGL,WACHA,EAAU+B,iBACVA,EAAgBC,kBAChBA,KAEA,4DAA4DhC,oBAA6B+B,gBAA+BC,qBAAqC3B,mBAE9J4B,KAAK,IAENtD,EAAKC,GAAG4B,UAAUF,C","sources":["fetchTopBooks.js","fetchById.js","src/index.js"],"sourcesContent":["const BASE_URL='https://books-backend.p.goit.global/books/top-books';\n\nasync function fetchTopBooks(){\n    return await fetch(`${BASE_URL}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchTopBooks};","const BASE_URL='https://books-backend.p.goit.global/books/';\n\nasync function fetchBookById(idBook){\n    return await fetch(`${BASE_URL}/${idBook}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchBookById};","import API from '../fetchTopBooks';\nimport AP from '../fetchById';\n\nconst refs={\n    ul: document.querySelector('.js-books-list'),\n    closeModalBtn: document.querySelector('[data-action=\"close-modal\"]'),\n    backdrop: document.querySelector('.js-backdrop'),\n    bookCard: document.querySelector('.js-book-card'),\n    shoppingListBtn: document.querySelector('[data-action=\"shopping-list-modal\"]'),\n    text: document.querySelector('.js-modal-text'),\n}\n\nconst STORAGE_KEY = 'bookId';\nlet idBook=0;\n// console.log(refs.closeModalBtn);\n// console.log(refs.backdrop);\n\nrefs.ul.addEventListener('click',onItemGalleryBooksClick);\nrefs.closeModalBtn.addEventListener('click', onCloseModal);\nrefs.backdrop.addEventListener('click', onBackdropClick);\nrefs.shoppingListBtn.addEventListener('click', onShoppingListBtnClick);\n\n///////////////////////////////////////////////////////////////////////////////////////\nAPI.fetchTopBooks().then(createMarkupGalleryBooks);\n//.catch(err=>console.log('Ooops! Something went wrong!'));\n\nfunction createMarkupGalleryBooks(arr) {\n    // console.log('createMarkupGalleryBooks',arr);\n    // console.log(arr[0].books[0]);\n    const markup=arr[0].books.map(\n        ({\n        _id,\n        book_image,\n        book_image_width,\n        book_image_height,\n        }) =>\n        `<li ><div class=\"thumb\"><img class=\"gallery__image\" src=\"${book_image}\" alt=\"\" width=\"${book_image_width}px\" height=\"${book_image_height}px\" data-source=\"${_id}\"/><div></li>`\n      )\n      .join(\"\");\n      // console.log(markup);\n      refs.ul.innerHTML=markup;\n }\n// ////////////////////////////////////////////////////////////////////////////////////\nfunction onItemGalleryBooksClick(event){\n    event.preventDefault();\n\n    const isImageGalleryEl=event.target.classList.contains('gallery__image');\n    if(!isImageGalleryEl){\n        return;\n    }\n\n    console.log(event.target.dataset.source);\n    idBook=event.target.dataset.source;\n\n    const isBookInLocalStorage=isInLocalStorage();\n\n    console.log('isBookInLocalStorage=',isBookInLocalStorage);\n\n    if(isBookInLocalStorage===idBook){\n      refs.shoppingListBtn.textContent='remove from the shopping list';\n      refs.shoppingListBtn.classList.add('modal__button-shopping-list--remove');\n      refs.text.classList.remove('visually-hidden');\n    }\n    else{\n      refs.shoppingListBtn.textContent='add to shopping list';\n      refs.text.classList.add('visually-hidden');\n      refs.shoppingListBtn.classList.remove('modal__button-shopping-list--remove');\n    }\n    refs.bookCard.innerHTML='';\n\n    AP.fetchBookById(idBook)\n    .then(createMarkupBookModal);\n    //.catch(err=>console.log('Ooops! Something went wrong!'));\n\n    onOpenModal();\n    \n}\n\n\n\n\nfunction onOpenModal() {\n    window.addEventListener('keydown', onEscKeyPress);\n    document.body.classList.add('show-modal');\n\n    //console.log('onOpenModal');\n\n\n}\n  \n  function onCloseModal() {\n    window.removeEventListener('keydown', onEscKeyPress);\n    document.body.classList.remove('show-modal');\n\n  }\n  \n  function onBackdropClick(event) {\n    if (event.currentTarget === event.target) {\n      //console.log('Кликнули именно в бекдроп!!!!');\n      onCloseModal();\n    }\n  }\n  \n  function onEscKeyPress(event) {\n    const ESC_KEY_CODE = 'Escape';\n    const isEscKey = event.code === ESC_KEY_CODE;\n    if (isEscKey) {\n      onCloseModal();\n    }\n  }\n\n  // function renderMarkupBookModal(arrayInfoBook){\n  //   createMarkupBookModal(arrayInfoBook);\n  // }\n\n  function createMarkupBookModal(arrayInfoBook){\n    //console.log('createMarkupBookModal: ', arrayInfoBook);\n\n    const {book_image, author, title, description,buy_links, _id}=arrayInfoBook;\n    \n    const markup=\n    `<div class=\"img-thumb\"><img class=\"book-image\"\" src=\"${book_image}\" alt=\"${title}\" loading=\"lazy\" data-source=\"${_id}\"/>\n    </div>\n    <div class=\"book-description-thumb\">\n    <p class=\"book-title\">${title}</p>\n    <p class=\"book-author\">${author}</p>\n    <p class=\"book-description\">${description}</p>\n    <div class=\"book-links\">\n    <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/amazon.jpg\" width=\"62px\" height=\"19px\"/>\n    </a>\n    <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/image1.jpg\" width=\"33px\" height=\"32px\"/>\n    </a>\n    <a href=\"${buy_links[4].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/bookshop.jpg\" width=\"38px\" height=\"36px\"/>\n    </a>\n    </div>\n    </div>`;\n\n    \n    //console.log(markup);\n    refs.bookCard.innerHTML=markup;\n  }\n\n\n  function onShoppingListBtnClick(event){\n    //const idBook=event.target.dataset.source;\n    const isBookInLocalStorage=isInLocalStorage();\n    if(isBookInLocalStorage===idBook){\n      localStorage.removeItem(STORAGE_KEY, idBook);\n    }\n    else{\n      localStorage.setItem(STORAGE_KEY, idBook);\n    }   \n    onCloseModal();\n  }\n\n  function isInLocalStorage(){\n    return localStorage.getItem(STORAGE_KEY, idBook);\n  }"],"names":["$795d36ee4409a10a$export$2e2bcd8739ae039","async","fetch","then","resp","ok","Error","statusText","json","$27d6f1b99820d37d$export$2e2bcd8739ae039","idBook","$1f0dc3b9307be026$var$refs","ul","document","querySelector","closeModalBtn","backdrop","bookCard","shoppingListBtn","text","$1f0dc3b9307be026$var$idBook","$1f0dc3b9307be026$var$onCloseModal","window","removeEventListener","$1f0dc3b9307be026$var$onEscKeyPress","body","classList","remove","event","code","$1f0dc3b9307be026$var$createMarkupBookModal","arrayInfoBook","book_image","author","title","description","buy_links","_id","markup","url","innerHTML","$1f0dc3b9307be026$var$isInLocalStorage","localStorage","getItem","addEventListener","preventDefault","target","contains","console","log","dataset","source","isBookInLocalStorage","textContent","add","fetchBookById","currentTarget","removeItem","setItem","fetchTopBooks","arr","books","map","book_image_width","book_image_height","join"],"version":3,"file":"index.38dab9d5.js.map"}