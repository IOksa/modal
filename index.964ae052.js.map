{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-7310763169f1275a.js","fetchTopBooks.js","fetchById.js","node_modules/@parcel/runtime-js/lib/runtime-9cc6be9e3e2c7555.js","node_modules/@parcel/runtime-js/lib/runtime-b775a9f1743c03cb.js","node_modules/@parcel/runtime-js/lib/runtime-c17619eb82d4e8e0.js","src/index.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"5ZPII\\\":\\\"index.964ae052.js\\\",\\\"aMVCO\\\":\\\"amazon.1427c9fc.jpg\\\",\\\"dSznB\\\":\\\"bookshop.0e4aa455.jpg\\\",\\\"b2DY9\\\":\\\"image1.c5cbee86.jpg\\\"}\"));","const BASE_URL='https://books-backend.p.goit.global/books/top-books';\n\nasync function fetchTopBooks(){\n    return await fetch(`${BASE_URL}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchTopBooks};","const BASE_URL='https://books-backend.p.goit.global/books/';\n\nasync function fetchBookById(idBook){\n    return await fetch(`${BASE_URL}/${idBook}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchBookById};","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"aMVCO\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"dSznB\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"b2DY9\")).toString();","import API from '../fetchTopBooks';\nimport AP from '../fetchById';\n\nimport imageAmazon from './images/amazon.jpg';\nimport imageBookShop from './images/bookshop.jpg';\nimport imageImage from './images/image1.jpg';\n\nconst refs={\n    ul: document.querySelector('.js-books-list'),\n    closeModalBtn: document.querySelector('[data-action=\"close-modal\"]'),\n    backdrop: document.querySelector('.js-backdrop'),\n    bookCard: document.querySelector('.js-book-card'),\n    shoppingListBtn: document.querySelector('[data-action=\"shopping-list-modal\"]'),\n    text: document.querySelector('.js-modal-text'),\n}\n\nconst STORAGE_KEY = 'bookId';\nlet idBook=0;\n\nconst savedData=localStorage.getItem(STORAGE_KEY);\nconsole.log('savedData=',savedData);\nlet arrShoppingList=JSON.parse(savedData) || [];\n\nconsole.log('arrShoppingList= ', arrShoppingList);\n\n// console.log(refs.closeModalBtn);\n// console.log(refs.backdrop);\n\nrefs.ul.addEventListener('click',onItemGalleryBooksClick);\nrefs.closeModalBtn.addEventListener('click', onCloseModal);\nrefs.backdrop.addEventListener('click', onBackdropClick);\nrefs.shoppingListBtn.addEventListener('click', onShoppingListBtnClick);\n\n///////////////////////////////////////////////////////////////////////////////////////\nAPI.fetchTopBooks().then(createMarkupGalleryBooks);\n//.catch(err=>console.log('Ooops! Something went wrong!'));\n\nfunction createMarkupGalleryBooks(arr) {\n    // console.log('createMarkupGalleryBooks',arr);\n    // console.log(arr[0].books[0]);\n    const markup=arr[0].books.map(\n        ({\n        _id,\n        book_image,\n        book_image_width,\n        book_image_height,\n        }) =>\n        `<li ><div class=\"thumb\"><img class=\"gallery__image\" src=\"${book_image}\" alt=\"\" width=\"${book_image_width}px\" height=\"${book_image_height}px\" data-source=\"${_id}\"/><div></li>`\n      )\n      .join(\"\");\n      // console.log(markup);\n      refs.ul.innerHTML=markup;\n }\n// ////////////////////////////////////////////////////////////////////////////////////\nfunction onItemGalleryBooksClick(event){\n    event.preventDefault();\n\n    const isImageGalleryEl=event.target.classList.contains('gallery__image');\n    if(!isImageGalleryEl){\n        return;\n    }\n\n    console.log(event.target.dataset.source);\n    idBook=event.target.dataset.source;\n\n    const isBookInShoppingList=arrShoppingList!==null?arrShoppingList.includes(idBook):false;\n\n    console.log('isBookInShoppingList=',isBookInShoppingList);\n\n    if(isBookInShoppingList){\n      refs.shoppingListBtn.textContent='remove from the shopping list';\n      refs.shoppingListBtn.classList.add('modal__button-shopping-list--remove');\n      refs.text.classList.remove('visually-hidden');\n    }\n    else{\n      refs.shoppingListBtn.textContent='add to shopping list';\n      refs.text.classList.add('visually-hidden');\n      refs.shoppingListBtn.classList.remove('modal__button-shopping-list--remove');\n    }\n    refs.bookCard.innerHTML='';\n\n    AP.fetchBookById(idBook)\n    .then(createMarkupBookModal);\n    //.catch(err=>console.log('Ooops! Something went wrong!'));\n\n    onOpenModal();\n    \n}\n\n\n\n\nfunction onOpenModal() {\n    window.addEventListener('keydown', onEscKeyPress);\n    document.body.classList.add('show-modal');\n\n    //console.log('onOpenModal');\n\n\n}\n  \n  function onCloseModal() {\n    window.removeEventListener('keydown', onEscKeyPress);\n    document.body.classList.remove('show-modal');\n\n  }\n  \n  function onBackdropClick(event) {\n    if (event.currentTarget === event.target) {\n      //console.log('Кликнули именно в бекдроп!!!!');\n      onCloseModal();\n    }\n  }\n  \n  function onEscKeyPress(event) {\n    const ESC_KEY_CODE = 'Escape';\n    const isEscKey = event.code === ESC_KEY_CODE;\n    if (isEscKey) {\n      onCloseModal();\n    }\n  }\n\n\n  function createMarkupBookModal(arrayInfoBook){\n    //console.log('createMarkupBookModal: ', arrayInfoBook);\n\n    const {book_image, author, title, description,buy_links, _id}=arrayInfoBook;\n    \n    const markup=\n    `<div class=\"img-thumb\"><img class=\"book-image\"\" src=\"${book_image}\" alt=\"${title}\" loading=\"lazy\" data-source=\"${_id}\"/>\n    </div>\n    <div class=\"book-description-thumb\">\n    <p class=\"book-title\">${title}</p>\n    <p class=\"book-author\">${author}</p>\n    <p class=\"book-description\">${description}</p>\n    <div class=\"book-links\">\n    <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageAmazon}\" width=\"62px\" height=\"19px\"/>\n    </a>\n    <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageImage}\" width=\"33px\" height=\"32px\"/>\n    </a>\n    <a href=\"${buy_links[4].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"${imageBookShop}\" width=\"38px\" height=\"36px\"/>\n    </a>\n    </div>\n    </div>`;\n\n    \n    //console.log(markup);\n    refs.bookCard.innerHTML=markup;\n  }\n\n\n  function onShoppingListBtnClick(event){\n    const indexBook=arrShoppingList.indexOf(idBook);\n    if(indexBook!==-1){\n      arrShoppingList.splice(indexBook,1);\n      localStorage.removeItem(STORAGE_KEY);\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }\n    else{\n      arrShoppingList.push(idBook);\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }   \n    onCloseModal();\n  }\n\n"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$795d36ee4409a10a$export$2e2bcd8739ae039","async","fetch","then","resp","ok","statusText","json","$27d6f1b99820d37d$export$2e2bcd8739ae039","idBook","$a37ce9e90c4fe847$exports","URL","resolve","import","meta","url","toString","$b0768e3c833ef454$exports","$246326594a1b55d9$exports","$1f0dc3b9307be026$var$refs","ul","document","querySelector","closeModalBtn","backdrop","bookCard","shoppingListBtn","text","$1f0dc3b9307be026$var$idBook","$1f0dc3b9307be026$var$savedData","localStorage","getItem","console","log","$1f0dc3b9307be026$var$arrShoppingList","$1f0dc3b9307be026$var$onCloseModal","window","removeEventListener","$1f0dc3b9307be026$var$onEscKeyPress","body","classList","remove","event","code","$1f0dc3b9307be026$var$createMarkupBookModal","arrayInfoBook","book_image","author","title","description","buy_links","_id","markup","$parcel$interopDefault","innerHTML","addEventListener","preventDefault","target","contains","dataset","source","isBookInShoppingList","includes","textContent","add","fetchBookById","currentTarget","indexBook","indexOf","splice","removeItem","setItem","stringify","push","fetchTopBooks","arr","books","map","book_image_width","book_image_height","join"],"version":3,"file":"index.964ae052.js.map"}