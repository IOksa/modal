{"mappings":"IAYAA,EAAe,C,cAVfC,iBACI,aAAaC,MAAM,uDAClBC,MAAMC,IACH,IAAKA,EAAKC,GACR,MAAM,IAAIC,MAAMF,EAAKG,YAEvB,OAAOH,EAAKI,MAAM,G,OCI1BC,EAAe,C,cAVfR,eAA6BS,GACzB,aAAaR,MAAM,8CAAeQ,KACjCP,MAAMC,IACH,IAAKA,EAAKC,GACR,MAAM,IAAIC,MAAMF,EAAKG,YAEvB,OAAOH,EAAKI,MAAM,G,GCL1B,MAAMG,EAAK,CACPC,GAAIC,SAASC,cAAc,kBAC3BC,cAAeF,SAASC,cAAc,+BACtCE,SAAUH,SAASC,cAAc,gBACjCG,SAAUJ,SAASC,cAAc,iBACjCI,gBAAiBL,SAASC,cAAc,uCACxCK,KAAMN,SAASC,cAAc,mBAIjC,IAAIM,EAAO,EAEX,MAAMC,EACJC,KAAKC,MAAMC,aAAaC,QAAQ,YAAc,GA8E9C,SAASC,IACPC,OAAOC,oBAAoB,UAAWC,GACtChB,SAASiB,KAAKC,UAAUC,OAAO,a,CAWjC,SAASH,EAAcI,GACA,WACJA,EAAMC,MAErBR,G,CAQJ,SAASS,EAAsBC,GAG7B,MAAMC,WAACA,EAAUC,OAAEA,EAAMC,MAAEA,EAAKC,YAAEA,EAAWC,UAACA,EAASC,IAAEA,GAAKN,EAExDO,EACN,wDAAwDN,WAAoBE,kCAAsCG,yFAG1FH,qCACCD,0CACKE,qDAEnBC,EAAU,GAAGG,4IAGbH,EAAU,GAAGG,4IAGbH,EAAU,GAAGG,uJAQxBjC,EAAKM,SAAS4B,UAAUF,C,CA7H5BhC,EAAKC,GAAGkC,iBAAiB,SA0BzB,SAAiCb,GAC7BA,EAAMc,iBAGN,IADuBd,EAAMe,OAAOjB,UAAUkB,SAAS,kBAEnD,OAGJC,QAAQC,IAAIlB,EAAMe,OAAOI,QAAQC,QACjCjC,EAAOa,EAAMe,OAAOI,QAAQC,OAE5B,MAAMC,EAAqBjC,EAAgBkC,SAASnC,GAEpD8B,QAAQC,IAAI,wBAAwBG,GAEjCA,GACD3C,EAAKO,gBAAgBsC,YAAY,gCACjC7C,EAAKO,gBAAgBa,UAAU0B,IAAI,uCACnC9C,EAAKQ,KAAKY,UAAUC,OAAO,qBAG3BrB,EAAKO,gBAAgBsC,YAAY,uBACjC7C,EAAKQ,KAAKY,UAAU0B,IAAI,mBACxB9C,EAAKO,gBAAgBa,UAAUC,OAAO,wCAExCrB,EAAKM,SAAS4B,UAAU,GAExBpC,EAAGiD,cAActC,GAChBjB,KAAKgC,GAWNR,OAAOmB,iBAAiB,UAAWjB,GACnChB,SAASiB,KAAKC,UAAU0B,IAAI,a,IAjEhC9C,EAAKI,cAAc+B,iBAAiB,QAASpB,GAC7Cf,EAAKK,SAAS8B,iBAAiB,SA6E7B,SAAyBb,GACnBA,EAAM0B,gBAAkB1B,EAAMe,QAEhCtB,G,IA/ENf,EAAKO,gBAAgB4B,iBAAiB,SA8HpC,SAAgCb,GAC9B,MAAM2B,EAAUvC,EAAgBwC,QAAQzC,IACzB,IAAZwC,GACDvC,EAAgByC,OAAOF,EAAUA,GACjCpC,aAAauC,WA9IC,SA8IuBzC,KAAK0C,UAAU3C,MAGpDA,EAAgB4C,KAAK7C,GACrBI,aAAa0C,QAlJC,SAkJoB5C,KAAK0C,UAAU3C,KAEnDK,G,IArIJ1B,EAAImE,gBAAgBhE,MAGpB,SAAkCiE,GAG9B,MAAMzB,EAAOyB,EAAI,GAAGC,MAAMC,KACtB,EAAC5B,IACDA,EAAGL,WACHA,EAAUkC,iBACVA,EAAgBC,kBAChBA,KAEA,4DAA4DnC,oBAA6BkC,gBAA+BC,qBAAqC9B,mBAE9J+B,KAAK,IAEN9D,EAAKC,GAAGiC,UAAUF,C","sources":["fetchTopBooks.js","fetchById.js","src/index.js"],"sourcesContent":["const BASE_URL='https://books-backend.p.goit.global/books/top-books';\n\nasync function fetchTopBooks(){\n    return await fetch(`${BASE_URL}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchTopBooks};","const BASE_URL='https://books-backend.p.goit.global/books/';\n\nasync function fetchBookById(idBook){\n    return await fetch(`${BASE_URL}/${idBook}`)\n    .then((resp) => {\n        if (!resp.ok) {\n          throw new Error(resp.statusText);\n        } \n        return resp.json();\n      });\n}\n\nexport default {fetchBookById};","import API from '../fetchTopBooks';\nimport AP from '../fetchById';\n\nconst refs={\n    ul: document.querySelector('.js-books-list'),\n    closeModalBtn: document.querySelector('[data-action=\"close-modal\"]'),\n    backdrop: document.querySelector('.js-backdrop'),\n    bookCard: document.querySelector('.js-book-card'),\n    shoppingListBtn: document.querySelector('[data-action=\"shopping-list-modal\"]'),\n    text: document.querySelector('.js-modal-text'),\n}\n\nconst STORAGE_KEY = 'bookId';\nlet idBook=0;\n\nconst arrShoppingList =\n  JSON.parse(localStorage.getItem('bookId')) || [];\n\n// console.log(refs.closeModalBtn);\n// console.log(refs.backdrop);\n\nrefs.ul.addEventListener('click',onItemGalleryBooksClick);\nrefs.closeModalBtn.addEventListener('click', onCloseModal);\nrefs.backdrop.addEventListener('click', onBackdropClick);\nrefs.shoppingListBtn.addEventListener('click', onShoppingListBtnClick);\n\n///////////////////////////////////////////////////////////////////////////////////////\nAPI.fetchTopBooks().then(createMarkupGalleryBooks);\n//.catch(err=>console.log('Ooops! Something went wrong!'));\n\nfunction createMarkupGalleryBooks(arr) {\n    // console.log('createMarkupGalleryBooks',arr);\n    // console.log(arr[0].books[0]);\n    const markup=arr[0].books.map(\n        ({\n        _id,\n        book_image,\n        book_image_width,\n        book_image_height,\n        }) =>\n        `<li ><div class=\"thumb\"><img class=\"gallery__image\" src=\"${book_image}\" alt=\"\" width=\"${book_image_width}px\" height=\"${book_image_height}px\" data-source=\"${_id}\"/><div></li>`\n      )\n      .join(\"\");\n      // console.log(markup);\n      refs.ul.innerHTML=markup;\n }\n// ////////////////////////////////////////////////////////////////////////////////////\nfunction onItemGalleryBooksClick(event){\n    event.preventDefault();\n\n    const isImageGalleryEl=event.target.classList.contains('gallery__image');\n    if(!isImageGalleryEl){\n        return;\n    }\n\n    console.log(event.target.dataset.source);\n    idBook=event.target.dataset.source;\n\n    const isBookInShoppingList=arrShoppingList.includes(idBook);\n\n    console.log('isBookInLocalStorage=',isBookInShoppingList);\n\n    if(isBookInShoppingList){\n      refs.shoppingListBtn.textContent='remove from the shopping list';\n      refs.shoppingListBtn.classList.add('modal__button-shopping-list--remove');\n      refs.text.classList.remove('visually-hidden');\n    }\n    else{\n      refs.shoppingListBtn.textContent='add to shopping list';\n      refs.text.classList.add('visually-hidden');\n      refs.shoppingListBtn.classList.remove('modal__button-shopping-list--remove');\n    }\n    refs.bookCard.innerHTML='';\n\n    AP.fetchBookById(idBook)\n    .then(createMarkupBookModal);\n    //.catch(err=>console.log('Ooops! Something went wrong!'));\n\n    onOpenModal();\n    \n}\n\n\n\n\nfunction onOpenModal() {\n    window.addEventListener('keydown', onEscKeyPress);\n    document.body.classList.add('show-modal');\n\n    //console.log('onOpenModal');\n\n\n}\n  \n  function onCloseModal() {\n    window.removeEventListener('keydown', onEscKeyPress);\n    document.body.classList.remove('show-modal');\n\n  }\n  \n  function onBackdropClick(event) {\n    if (event.currentTarget === event.target) {\n      //console.log('Кликнули именно в бекдроп!!!!');\n      onCloseModal();\n    }\n  }\n  \n  function onEscKeyPress(event) {\n    const ESC_KEY_CODE = 'Escape';\n    const isEscKey = event.code === ESC_KEY_CODE;\n    if (isEscKey) {\n      onCloseModal();\n    }\n  }\n\n  // function renderMarkupBookModal(arrayInfoBook){\n  //   createMarkupBookModal(arrayInfoBook);\n  // }\n\n  function createMarkupBookModal(arrayInfoBook){\n    //console.log('createMarkupBookModal: ', arrayInfoBook);\n\n    const {book_image, author, title, description,buy_links, _id}=arrayInfoBook;\n    \n    const markup=\n    `<div class=\"img-thumb\"><img class=\"book-image\"\" src=\"${book_image}\" alt=\"${title}\" loading=\"lazy\" data-source=\"${_id}\"/>\n    </div>\n    <div class=\"book-description-thumb\">\n    <p class=\"book-title\">${title}</p>\n    <p class=\"book-author\">${author}</p>\n    <p class=\"book-description\">${description}</p>\n    <div class=\"book-links\">\n    <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/amazon.jpg\" width=\"62px\" height=\"19px\"/>\n    </a>\n    <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/image1.jpg\" width=\"33px\" height=\"32px\"/>\n    </a>\n    <a href=\"${buy_links[4].url}\" target=\"_blank\" rel=\"noreferrer noopener\">\n    <img src=\"./images/bookshop.jpg\" width=\"38px\" height=\"36px\"/>\n    </a>\n    </div>\n    </div>`;\n\n    \n    //console.log(markup);\n    refs.bookCard.innerHTML=markup;\n  }\n\n\n  function onShoppingListBtnClick(event){\n    const indexBook=arrShoppingList.indexOf(idBook);\n    if(indexBook!==-1){\n      arrShoppingList.splice(indexBook,indexBook);\n      localStorage.removeItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }\n    else{\n      arrShoppingList.push(idBook);\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(arrShoppingList));\n    }   \n    onCloseModal();\n  }\n\n"],"names":["$795d36ee4409a10a$export$2e2bcd8739ae039","async","fetch","then","resp","ok","Error","statusText","json","$27d6f1b99820d37d$export$2e2bcd8739ae039","idBook","$1f0dc3b9307be026$var$refs","ul","document","querySelector","closeModalBtn","backdrop","bookCard","shoppingListBtn","text","$1f0dc3b9307be026$var$idBook","$1f0dc3b9307be026$var$arrShoppingList","JSON","parse","localStorage","getItem","$1f0dc3b9307be026$var$onCloseModal","window","removeEventListener","$1f0dc3b9307be026$var$onEscKeyPress","body","classList","remove","event","code","$1f0dc3b9307be026$var$createMarkupBookModal","arrayInfoBook","book_image","author","title","description","buy_links","_id","markup","url","innerHTML","addEventListener","preventDefault","target","contains","console","log","dataset","source","isBookInShoppingList","includes","textContent","add","fetchBookById","currentTarget","indexBook","indexOf","splice","removeItem","stringify","push","setItem","fetchTopBooks","arr","books","map","book_image_width","book_image_height","join"],"version":3,"file":"index.17018c73.js.map"}